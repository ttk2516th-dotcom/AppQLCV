<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Tr·ª£ l√Ω Gi√°o vi√™n</title>
<script src="https://cdn.tailwindcss.com"></script>

<style>
/* ===== BASIC ===== */
.today { background:#dbeafe }
.other-month { color:#9ca3af }
.dot {
  width:6px;height:6px;border-radius:50%;
  display:inline-block;margin-right:2px
}

/* ===== BOTTOM BAR WITH CURVE ===== */
.bottom-bar {
  position:fixed;
  bottom:0; left:0; right:0;
  height:72px;
  background:#fff;
  border-top-left-radius:24px;
  border-top-right-radius:24px;
  box-shadow:0 -2px 10px rgba(0,0,0,.08);
  display:flex;
  justify-content:space-around;
  align-items:center;
  z-index:1000;
}

/* notch */
.bottom-bar::before {
  content:"";
  position:absolute;
  top:-28px;
  left:50%;
  transform:translateX(-50%);
  width:84px;
  height:56px;
  background:#fff;
  border-radius:0 0 42px 42px;
  box-shadow:0 -4px 10px rgba(0,0,0,.08);
}

/* ===== CENTER PLUS ===== */
.center-plus {
  position:fixed;
  bottom:36px;
  left:50%;
  transform:translateX(-50%);
  width:64px;
  height:64px;
  border-radius:50%;
  background:#2563eb;
  color:#fff;
  font-size:34px;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:1100;
  box-shadow:0 10px 25px rgba(0,0,0,.3);
}

/* ===== MODAL ===== */
.modal-bg {
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.45);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:2000;
}
.modal {
  background:#fff;
  width:92%;
  max-width:520px;
  border-radius:16px;
  padding:16px;
  max-height:90vh;
  overflow:auto;
}
</style>
</head>

<body class="bg-gray-100 pb-24">

<div class="max-w-md mx-auto bg-white min-h-screen">
<header class="p-4 text-center font-bold text-xl border-b">
üìò Tr·ª£ l√Ω Gi√°o vi√™n
</header>

<main class="p-3">

<!-- TAB MONTH -->
<section id="tab-month">
  <div class="flex justify-between mb-2">
    <button onclick="changeMonth(-1)">‚óÄ</button>
    <h2 id="monthTitle" class="font-semibold"></h2>
    <button onclick="changeMonth(1)">‚ñ∂</button>
  </div>

  <div class="grid grid-cols-7 text-center text-xs font-semibold mb-1">
    <div>CN</div><div>T2</div><div>T3</div><div>T4</div>
    <div>T5</div><div>T6</div><div>T7</div>
  </div>

  <div id="monthGrid" class="grid grid-cols-7 gap-1"></div>
</section>

<!-- TAB DAY -->
<section id="tab-day" class="hidden">
  <h2 id="dayTitle" class="font-semibold mb-2"></h2>
  <div id="dayTasks" class="space-y-2 text-sm"></div>
</section>

</main>
</div>

<!-- CENTER PLUS -->
<button class="center-plus" onclick="openModal()">Ôºã</button>

<!-- BOTTOM BAR -->
<div class="bottom-bar">
  <button onclick="showTab('month')">üìÖ<br>Th√°ng</button>
  <button onclick="showTab('day')">‚è∞<br>Ng√†y</button>
  <div style="width:72px"></div>
  <button>üìä<br>B√°o c√°o</button>
  <button>‚öôÔ∏è<br>C√†i ƒë·∫∑t</button>
</div>

<!-- MODAL -->
<div id="modalBg" class="modal-bg">
<div class="modal">
<h3 class="font-semibold mb-2">‚ûï Th√™m c√¥ng vi·ªác</h3>

<input id="mTitle" class="w-full border p-2 rounded mb-2" placeholder="T√™n c√¥ng vi·ªác">

<label class="text-sm">Ng√†y b·∫Øt ƒë·∫ßu</label>
<input id="mStartDate" type="date" class="w-full border p-2 rounded mb-2">

<label class="text-sm">Gi·ªù b·∫Øt ƒë·∫ßu</label>
<input id="mStartTime" type="time" class="w-full border p-2 rounded mb-2">

<label class="text-sm">Ng√†y k·∫øt th√∫c</label>
<input id="mEndDate" type="date" class="w-full border p-2 rounded mb-2">

<label class="text-sm">Gi·ªù k·∫øt th√∫c</label>
<input id="mEndTime" type="time" class="w-full border p-2 rounded mb-3">

<select id="mRepeat" class="w-full border p-2 rounded mb-3">
  <option value="NONE">Kh√¥ng l·∫∑p</option>
  <option value="DAILY">L·∫∑p m·ªói ng√†y (gi·ªØ gi·ªù)</option>
  <option value="WEEKLY">L·∫∑p theo th·ª© trong tu·∫ßn</option>
  <option value="MONTHLY">L·∫∑p theo ng√†y trong th√°ng</option>
</select>

<div class="flex justify-end gap-3">
<button onclick="closeModal()">Hu·ª∑</button>
<button class="bg-blue-600 text-white px-4 py-2 rounded" onclick="saveTask()">L∆∞u</button>
</div>
</div>
</div>

<script>
/* ===== DATE UTILS (NO TIMEZONE BUG) ===== */
const pad=n=>String(n).padStart(2,'0');
const toYMD=d=>`${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;

/* ===== STATE ===== */
let tasks=JSON.parse(localStorage.getItem('tasks')||'[]');
let viewDate=new Date();
let selectedDate=new Date();

/* ===== TAB ===== */
function showTab(t){
  tabMonth.classList.toggle('hidden',t!=='month');
  tabDay.classList.toggle('hidden',t!=='day');
  if(t==='day') renderDay();
}

/* ===== MONTH ===== */
function changeMonth(s){ viewDate.setMonth(viewDate.getMonth()+s); renderMonth(); }

function renderMonth(){
  monthGrid.innerHTML='';
  const y=viewDate.getFullYear(), m=viewDate.getMonth();
  monthTitle.innerText=`Th√°ng ${m+1}/${y}`;

  const first=new Date(y,m,1).getDay();
  const start=new Date(y,m,1-first);

  for(let i=0;i<42;i++){
    const d=new Date(start); d.setDate(start.getDate()+i);
    const ymd=toYMD(d);

    const cell=document.createElement('div');
    cell.className='border rounded p-1 text-xs min-h-[60px]';
    if(d.getMonth()!==m) cell.classList.add('other-month');
    if(ymd===toYMD(new Date())) cell.classList.add('today');

    cell.innerHTML=`<div>${d.getDate()}</div>`;

    tasks.filter(t=>t.startDate<=ymd && t.endDate>=ymd)
      .forEach(()=>cell.innerHTML+=`<span class="dot bg-blue-600"></span>`);

    cell.onclick=()=>{selectedDate=d;showTab('day')};
    monthGrid.appendChild(cell);
  }
}

/* ===== DAY ===== */
function renderDay(){
  dayTitle.innerText=selectedDate.toLocaleDateString('vi-VN');
  dayTasks.innerHTML='';
  const ymd=toYMD(selectedDate);

  tasks.filter(t=>t.startDate<=ymd && t.endDate>=ymd)
    .forEach(t=>{
      dayTasks.innerHTML+=`
        <div class="border p-2 rounded">
          <b>${t.title}</b><br>
          ${t.startDate} ${t.startTime} ‚Üí ${t.endDate} ${t.endTime}
        </div>`;
    });
}

/* ===== MODAL ===== */
function openModal(){
  modalBg.style.display='flex';
  const d=toYMD(selectedDate);
  mStartDate.value=d;
  mEndDate.value=d;
}
function closeModal(){ modalBg.style.display='none'; }

function saveTask(){
  tasks.push({
    id:Date.now(),
    title:mTitle.value,
    startDate:mStartDate.value,
    endDate:mEndDate.value,
    startTime:mStartTime.value,
    endTime:mEndTime.value,
    repeat:mRepeat.value
  });
  localStorage.setItem('tasks',JSON.stringify(tasks));
  closeModal(); renderMonth(); renderDay();
}

/* INIT */
renderMonth();
</script>

</body>
</html>
