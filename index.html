<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Trá»£ lÃ½ GiÃ¡o viÃªn</title>

<script src="https://cdn.tailwindcss.com"></script>

<style>
.today{background:#dbeafe}
.other-month{color:#9ca3af}
.dot{width:6px;height:6px;border-radius:50%;display:inline-block;margin-right:2px}

/* ===== BOTTOM BAR ===== */
.bottom-bar{
  position:fixed;
  bottom:0;
  left:0;
  right:0;
  height:64px;
  background:#fff;
  border-top:1px solid #e5e7eb;
  display:flex;
  justify-content:space-around;
  align-items:center;
  z-index:1000;
}

/* ===== CENTER + BUTTON ===== */
.center-plus{
  position:fixed;
  bottom:32px;          /* Gáº®N DÃNH Vá»šI THANH TAB */
  left:50%;
  transform:translateX(-50%);
  width:64px;
  height:64px;
  border-radius:50%;
  background:#2563eb;
  color:#fff;
  font-size:34px;
  display:flex;
  align-items:center;
  justify-content:center;
  z-index:1100;
  box-shadow:0 8px 20px rgba(0,0,0,.3);
}

/* ===== MODAL ===== */
.modal-bg{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.45);
  display:none;
  align-items:center;
  justify-content:center;
  z-index:2000;
}
.modal{
  background:#fff;
  width:92%;
  max-width:440px;
  border-radius:16px;
  padding:16px;
  max-height:90vh;
  overflow:auto;
}
</style>
</head>

<body class="bg-gray-100 pb-20">

<div class="max-w-md mx-auto bg-white min-h-screen">

<header class="p-4 text-center font-bold text-xl border-b">
ğŸ“˜ Trá»£ lÃ½ GiÃ¡o viÃªn
</header>

<main class="p-3">

<!-- ===== TAB THÃNG ===== -->
<section id="tab-month">
  <div class="flex justify-between items-center mb-2">
    <button onclick="changeMonth(-1)">â—€</button>
    <h2 id="monthTitle" class="font-semibold"></h2>
    <button onclick="changeMonth(1)">â–¶</button>
  </div>

  <div class="grid grid-cols-7 text-center text-xs font-semibold mb-1">
    <div>CN</div><div>T2</div><div>T3</div><div>T4</div>
    <div>T5</div><div>T6</div><div>T7</div>
  </div>

  <div id="monthGrid" class="grid grid-cols-7 gap-1"></div>
</section>

<!-- ===== TAB NGÃ€Y ===== -->
<section id="tab-day" class="hidden">
  <h2 id="dayTitle" class="font-semibold mb-2"></h2>
  <div id="dayTasks" class="space-y-2 text-sm"></div>
</section>

<section id="tab-report" class="hidden">
  <p class="text-sm text-gray-500">ğŸ“Š BÃ¡o cÃ¡o (sáº½ triá»ƒn khai)</p>
</section>

<section id="tab-settings" class="hidden">
  <p class="text-sm text-gray-500">âš™ï¸ Chá»§ Ä‘á» máº«u (sáº½ triá»ƒn khai)</p>
</section>

</main>
</div>

<!-- ===== CENTER PLUS ===== -->
<button class="center-plus" onclick="openModal()">ï¼‹</button>

<!-- ===== BOTTOM NAV ===== -->
<div class="bottom-bar">
  <button onclick="showTab('month')">ğŸ“…<br>ThÃ¡ng</button>
  <button onclick="showTab('day')">â°<br>NgÃ y</button>
  <div style="width:64px"></div>
  <button onclick="showTab('report')">ğŸ“Š<br>BÃ¡o cÃ¡o</button>
  <button onclick="showTab('settings')">âš™ï¸<br>CÃ i Ä‘áº·t</button>
</div>

<!-- ===== MODAL ADD TASK ===== -->
<div id="modalBg" class="modal-bg">
<div class="modal">

<h3 class="font-semibold mb-2">â• ThÃªm cÃ´ng viá»‡c</h3>

<input id="mTitle" class="w-full border p-2 rounded mb-2" placeholder="TÃªn cÃ´ng viá»‡c">

<select id="mRole" class="w-full border p-2 rounded mb-2">
  <option value="GVDL">GVDL</option>
  <option value="GVCN">GVCN</option>
  <option value="TTCM">TTCM</option>
  <option value="DANG">Äáº£ng viÃªn</option>
  <option value="DOAN">ÄoÃ n viÃªn</option>
  <option value="DOI">Há»— trá»£ Äá»™i</option>
  <option value="KHAC">KhÃ¡c</option>
</select>

<textarea id="mDetail" class="w-full border p-2 rounded mb-2"
 placeholder="Chi tiáº¿t cÃ´ng viá»‡c"></textarea>

<label class="text-xs">Báº¯t Ä‘áº§u</label>
<input id="mStart" type="datetime-local"
 class="w-full border p-2 rounded mb-2" onchange="syncEnd()">

<label class="text-xs">Káº¿t thÃºc</label>
<input id="mEnd" type="datetime-local"
 class="w-full border p-2 rounded mb-2">

<!-- ===== CHáº¾ Äá»˜ ===== -->
<select id="mMode" class="w-full border p-2 rounded mb-2">
  <option value="FIXED">CV Ä‘Ãºng háº¡n</option>
  <option value="FLEX">CV linh Ä‘á»™ng</option>
</select>

<!-- ===== Láº¶P Láº I ===== -->
<div class="border rounded p-2 mb-2 text-sm">
<b>Láº·p láº¡i</b><br>
<label><input type="checkbox" id="rHour"> Theo giá»</label><br>
<label><input type="checkbox" id="rDay"> Theo ngÃ y</label><br>
<label><input type="checkbox" id="rMonth"> Theo thÃ¡ng</label>
</div>

<!-- ===== THÃ”NG BÃO ===== -->
<div class="border rounded p-2 mb-3 text-sm">
<b>ğŸ”” ThÃ´ng bÃ¡o</b><br>
<label><input type="checkbox" id="n1d"> TrÆ°á»›c 1 ngÃ y</label><br>
<label><input type="checkbox" id="n1h"> TrÆ°á»›c 1 giá»</label><br>
<label><input type="checkbox" id="nStart"> Khi báº¯t Ä‘áº§u</label><br>
<label><input type="checkbox" id="nHalf"> Khi trÃ´i qua 50%</label><br>
<label><input type="checkbox" id="nEnd1d"> TrÆ°á»›c khi káº¿t thÃºc 1 ngÃ y</label><br>
<label><input type="checkbox" id="nEnd1h"> TrÆ°á»›c khi káº¿t thÃºc 1 giá»</label><br>
<label><input type="checkbox" id="nEnd"> Khi Ä‘Ã£ káº¿t thÃºc</label>
</div>

<div class="flex justify-end gap-3">
<button onclick="closeModal()">Huá»·</button>
<button class="bg-blue-600 text-white px-4 py-2 rounded"
 onclick="saveTask()">LÆ°u</button>
</div>

</div>
</div>

<script>
const ROLE_COLOR={
GVDL:'#2563eb',GVCN:'#16a34a',TTCM:'#7c3aed',
DANG:'#dc2626',DOAN:'#f97316',DOI:'#06b6d4',KHAC:'#6b7280'
};

let tasks=JSON.parse(localStorage.getItem('tasks')||'[]');
let viewDate=new Date();
let selectedDate=new Date();

function showTab(t){
['month','day','report','settings'].forEach(x=>{
document.getElementById('tab-'+x)?.classList.add('hidden');
});
document.getElementById('tab-'+t)?.classList.remove('hidden');
if(t==='day') renderDay();
}

function changeMonth(s){
viewDate.setMonth(viewDate.getMonth()+s);
renderMonth();
}

function renderMonth(){
const grid=document.getElementById('monthGrid');
grid.innerHTML='';
const y=viewDate.getFullYear();
const m=viewDate.getMonth();
monthTitle.innerText=`ThÃ¡ng ${m+1}/${y}`;

const first=new Date(y,m,1).getDay();
const start=new Date(y,m,1-first);

for(let i=0;i<42;i++){
const d=new Date(start); d.setDate(start.getDate()+i);
const cell=document.createElement('div');
cell.className='border rounded p-1 text-xs min-h-[60px]';
if(d.getMonth()!==m) cell.classList.add('other-month');
if(isToday(d)) cell.classList.add('today');

cell.innerHTML=`<div>${d.getDate()}</div>`;
tasks.filter(t=>sameDay(new Date(t.start),d)).forEach(t=>{
const dot=document.createElement('span');
dot.className='dot';
dot.style.background=ROLE_COLOR[t.role];
cell.appendChild(dot);
});

cell.onclick=()=>{selectedDate=d;showTab('day')};
grid.appendChild(cell);
}
}

function renderDay(){
dayTitle.innerText='ğŸ“… '+formatDate(selectedDate);
const list=document.getElementById('dayTasks');
list.innerHTML='';
tasks.filter(t=>sameDay(new Date(t.start),selectedDate))
.forEach(t=>{
list.innerHTML+=`
<div class="border p-2 rounded">
<b style="color:${ROLE_COLOR[t.role]}">${t.title}</b><br>
${formatDateTime(t.start)} â†’ ${formatDateTime(t.end)}
</div>`;
});
}

function openModal(){
modalBg.style.display='flex';
const d=selectedDate.toISOString().slice(0,10);
mStart.value=d+'T07:00';
mEnd.value=d+'T07:00';
}
function closeModal(){modalBg.style.display='none'}
function syncEnd(){mEnd.value=mStart.value}

function saveTask(){
tasks.push({
id:Date.now(),
title:mTitle.value,
detail:mDetail.value,
role:mRole.value,
start:mStart.value,
end:mEnd.value,
mode:mMode.value,
repeat:{
hour:rHour.checked,
day:rDay.checked,
month:rMonth.checked
},
notify:{
beforeDay:n1d.checked,
beforeHour:n1h.checked,
start:nStart.checked,
half:nHalf.checked,
endDay:nEnd1d.checked,
endHour:nEnd1h.checked,
end:nEnd.checked
}
});
localStorage.setItem('tasks',JSON.stringify(tasks));
closeModal();
renderMonth();
}

function sameDay(a,b){return a.toDateString()===b.toDateString()}
function isToday(d){return sameDay(d,new Date())}
function formatDate(d){return d.toLocaleDateString('vi-VN')}
function formatDateTime(v){
const d=new Date(v);
return d.toLocaleDateString('vi-VN')+' - '+d.toLocaleTimeString('vi-VN',{hour:'2-digit',minute:'2-digit'});
}

renderMonth();
</script>

</body>
</html>
